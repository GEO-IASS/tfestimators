<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-level Estimator Interface to TensorFlow in R • tfestimators</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">tfestimators</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Using
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="articles/using_estimators.html">Using Estimators</a>
    </li>
    <li>
      <a href="articles/input_functions.html">Input Functions</a>
    </li>
    <li>
      <a href="articles/feature_columns.html">Feature Columns</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced</li>
    <li>
      <a href="articles/experiments.html">Experiments</a>
    </li>
    <li>
      <a href="articles/run_hooks.html">Run Hooks</a>
    </li>
    <li>
      <a href="articles/custom_estimators.html">Custom Estimators</a>
    </li>
    <li>
      <a href="articles/tensorboard.html">TensorBoard Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/tfestimators">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="r-interface-to-tensorflow-estimators" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#r-interface-to-tensorflow-estimators" class="anchor"></a>R Interface to TensorFlow Estimators</h1></div>
<style type="text/css">
.alert-warning {
    color: #8a6d3b;
    background-color: #fcf8e3;
    margin-top: 20px;
    margin-bottom: 20px;
    background-image: linear-gradient(to bottom,#fcf8e3 0,#f8efc0 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fffcf8e3', endColorstr='#fff8efc0', GradientType=0);
    background-repeat: repeat-x;
    border: 1px solid #f5e79e;
    border-radius: 4px;
}
</style>
<div class="alert alert-warning" role="alert">
<p><strong>IMPORTANT NOTE</strong>: This package is under active development and the APIs are still subject to substantial changes. Help and documentation are also currently incomplete. The package is currently suitable for review and feedback but not for everyday use.</p>
</div>
<p><img src="images/tensorflow-2-100709406-large.jpg" align="right" width="50%" style="margin-left: 15px;"></p>
<p>The <strong>tfestimators</strong> package is an R interface to TensorFlow Estimators, a high-level API that provides:</p>
<ul>
<li><p>Implementations of many model types including linear models, support vector machines, deep neural networks, state saving recurrent neural networks, and dynamic recurrent neural networks.</p></li>
<li><p>A flexible framework for defining arbitrary new model types (Estimators)</p></li>
<li><p>Standalone deployment of models (no R runtime required) in a wide variety of environments.</p></li>
<li><p>An Experiment API that provides distributed training and hyperparameter tuning for both canned and custom estimators.</p></li>
</ul>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>To use <strong>tfestimators</strong> you need to install both the R package as well as <a href="https://rstudio.github.io/tensorflow/">TensorFlow</a> iteslf.</p>
<p>First, install the tfestimators R package as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"rstudio/tfestimators"</span>)</code></pre></div>
<p>Then, use the <code><a href="http://www.rdocumentation.org/packages/tensorflow/topics/install_tensorflow">install_tensorflow()</a></code> function to install the current nightly build of TensorFlow (see the TensorFlow repository home page for <a href="https://github.com/tensorflow/tensorflow#installation">nightly build URLs</a> for various platforms):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tfestimators)
<span class="kw"><a href="http://www.rdocumentation.org/packages/tensorflow/topics/install_tensorflow">install_tensorflow</a></span>(<span class="dt">package_url =</span> <span class="st">"https://ci.tensorflow.org/view/Nightly/&lt;path-to-tf-package&gt;"</span>)</code></pre></div>
<div class="alert alert-warning" role="alert">
<p><strong>IMPORTANT NOTE</strong>: The <strong>tfestimators</strong> package currently requires the nightly build of TensorFlow, it will not work with the release version as it relies on APIs only in the development version.</p>
</div>
</div>
<div id="simple-example" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-example" class="anchor"></a>Simple Example</h3>
<p>Let’s create a simple linear regression with the <code>mtcars</code> dataset to demonstrate the use of estimators.</p>
<div id="input-function" class="section level4">
<h4 class="hasAnchor">
<a href="#input-function" class="anchor"></a>Input Function</h4>
<p>First, some standard setup. Input to estimators is provided by an input function that returns a list containing feature and response data. You can write a custom input function or create one automatically from an R data frame, matrix, or list.</p>
<p>Here we define a helper function that will return an input function for a given subset of our data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tfestimators)

<span class="co"># return an input_fn for a given subset of data</span>
mtcars_input_fn &lt;-<span class="st"> </span>function(data) {
  <span class="kw"><a href="reference/input_fn.html">input_fn</a></span>(data, <span class="dt">features =</span> <span class="kw">c</span>(disp, cyl), <span class="dt">response =</span> mpg)
}</code></pre></div>
<p>The <code>input_fn</code> method can take an R data frame or matrix along with the names of feature and response variables and automatically create an input function for it.</p>
</div>
<div id="feature-columns" class="section level4">
<h4 class="hasAnchor">
<a href="#feature-columns" class="anchor"></a>Feature Columns</h4>
<p>Next we define the feature columns for our model. Feature columns are mappings of raw input data to the data that we’ll actually feed into our training, evaluation, and prediction steps. Here we create a list of feature columns containing the <code>disp</code> and <code>cyl</code> variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fc &lt;-<span class="st"> </span><span class="kw"><a href="reference/feature_columns.html">feature_columns</a></span>(
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"disp"</span>),
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"cyl"</span>)
)</code></pre></div>
<p>You can also define multiple feature columns at once:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fc &lt;-<span class="st"> </span><span class="kw"><a href="reference/feature_columns.html">feature_columns</a></span>( 
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"disp"</span>, <span class="st">"cyl"</span>)
)</code></pre></div>
<p>By using the family of <a href="reference/index.html#section-feature-columns">feature column functions</a> we can define various transformations on the data before using it for modeling.</p>
</div>
<div id="estimator" class="section level4">
<h4 class="hasAnchor">
<a href="#estimator" class="anchor"></a>Estimator</h4>
<p>We create the estimator by calling <code><a href="reference/linear_regressor.html">linear_regressor()</a></code> function and passing it a set of feature columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw"><a href="reference/linear_regressor.html">linear_regressor</a></span>(fc)</code></pre></div>
</div>
<div id="training" class="section level4">
<h4 class="hasAnchor">
<a href="#training" class="anchor"></a>Training</h4>
<p>Next, we train the model using the <code>train()</code> function. Note that we segment <code>mtcars</code> into training and test datasets so we can evaluate the model on a differnet subset of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># randomly segment mtcars into test and training datasets</span>
mtcars &lt;-<span class="st"> </span>mtcars[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(mtcars)),]
test_obs &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="fl">0.2</span> *<span class="st"> </span><span class="kw">nrow</span>(mtcars))
train &lt;-<span class="st"> </span>mtcars[-(<span class="dv">1</span>:test_obs),]
test &lt;-<span class="st"> </span>mtcars[<span class="dv">1</span>:test_obs,]

<span class="co"># train the model</span>
model %&gt;%<span class="st"> </span><span class="kw">train</span>(<span class="kw">mtcars_input_fn</span>(train))</code></pre></div>
</div>
<div id="evaluation" class="section level4">
<h4 class="hasAnchor">
<a href="#evaluation" class="anchor"></a>Evaluation</h4>
<p>We can evaluate the model’s accuracy using the <code>evaluate()</code> function (here we use the <code>test</code> dataset rather than the <code>train</code> dataset):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model %&gt;%<span class="st"> </span><span class="kw">evaluate</span>(<span class="kw">mtcars_input_fn</span>(test))</code></pre></div>
<pre><code>## $loss
## [1] 359.7867
## 
## $global_step
## [1] 2</code></pre>
</div>
<div id="prediction" class="section level4">
<h4 class="hasAnchor">
<a href="#prediction" class="anchor"></a>Prediction</h4>
<p>Finally, we generate predictions using the <code>predict()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obs &lt;-<span class="st"> </span>mtcars[<span class="dv">1</span>:<span class="dv">3</span>,]
model %&gt;%<span class="st"> </span><span class="kw">predict</span>(<span class="kw">mtcars_input_fn</span>(obs))</code></pre></div>
<pre><code>##   scores   scores   scores 
## 3.121647 1.160572 1.780318</code></pre>
</div>
</div>
</div>
<div id="learning-more" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-more" class="anchor"></a>Learning More</h2>
<p>These articles cover the basics of using TensorFlow Estimators:</p>
<ul>
<li><a href="articles/using_estimators.html">Using Estimators</a></li>
<li><a href="articles/input_functions.html">Input Functions</a></li>
<li><a href="articles/feature_columns.html">Feature Columns</a></li>
</ul>
<!--
These articles provide in depth documentation and example uses of canned estimators:

- [Linear Models](articles/linear_estimators.html)
- [Linear/DNN Models](articles/linear_dnn_combined_estimators.html)
- [Support Vector Machines](articles/support_vector_machines.html)
- [Recurrent Neural Networks](articles/recurrent_neural_networks.html)
--><p>These articles describe more advanced topics/usage:</p>
<ul>
<li><a href="articles/experiments.html">Experiments</a></li>
<li>
<a href="articles/run_hooks.html">Run Hooks</a> <!--
- [Run Configuration](articles/run_configuration.html)
-->
</li>
<li><a href="articles/custom_estimators.html">Custom Estimators</a></li>
<li><a href="articles/tensorboard.html">TensorBoard Visualization</a></li>
</ul>
<p>One of the best ways to learn is from reviewing and experimenting with examples. See the <a href="articles/examples/examples.html">Examples</a> page for a variety of examples to help you get started.</p>
<!--
When you have built your model and are ready to deploy it, see the [Deployment](articles/deployment.html) page for an in-depth review of deployment options.
-->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/rstudio/tfestimators">https://​github.com/​rstudio/​tfestimators</a>
</li>
<li>Report a bug at <br><a href="https://github.com/rstudio/tfestimators/issues">https://​github.com/​rstudio/​tfestimators/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>Apache License 2.0</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yuan Tang <br><small class="roles"> Author, maintainer </small> </li>
<li>JJ Allaire <br><small class="roles"> Author </small> </li>
<li>
<a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a> <br><small class="roles"> Copyright holder, funder </small> </li>
<li>Kevin Ushey <br><small class="roles"> Author </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Yuan Tang, JJ Allaire, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>, Kevin Ushey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
