<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Estimators • tfestimators</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tfestimators</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Using
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/using_estimators.html">Using Estimators</a>
    </li>
    <li>
      <a href="../articles/input_functions.html">Input Functions</a>
    </li>
    <li>
      <a href="../articles/feature_columns.html">Feature Columns</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/experiments.html">Experiments</a>
    </li>
    <li>
      <a href="../articles/run_hooks.html">Run Hooks</a>
    </li>
    <li>
      <a href="../articles/custom_estimators.html">Custom Estimators</a>
    </li>
    <li>
      <a href="../articles/tensorboard.html">TensorBoard Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/tfestimators">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using Estimators</h1>
            
          </div>

    
    
<div class="contents">
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The core components of the TensorFlow Estimator API include:</p>
<ul>
<li><p>Canned estimators (pre-built implementations of various models).</p></li>
<li><p>Custom estimators (custom model implementations).</p></li>
<li><p>Estimator methods (core methods like <code>train()</code>, <code>predict()</code>, etc. which work the same for all canned and custom estimators).</p></li>
<li><p>Feature columns (definitions of how features should be transformed during modeling).</p></li>
<li><p>Input functions (sources of data for training and prediction).</p></li>
</ul>
<p>In addition, there are APIs that cover more advanced training scenarios:</p>
<ul>
<li><p>Experiments (wrappers around estimators that handle concerns like distributed training, hyperparameter tuning, etc.)</p></li>
<li><p>Run hooks (callbacks for recording context and interacting with training as it proceeds)</p></li>
</ul>
<p>Below we enumerate some of the core functions in each of these componets to provide a high level overview of what’s available. See the linked articles for more details on using all of the components together.</p>
</div>
<div id="canned-estimators" class="section level2">
<h2 class="hasAnchor">
<a href="#canned-estimators" class="anchor"></a>Canned Estimators</h2>
<p>The <strong>tfestimators</strong> package includes a wide variety of canned estimators for common machine learning tasks. Available estimators include:</p>
<table class="table">
<thead><tr class="header">
<th>Estimator</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/linear_regressor.html">linear_regressor()</a></code></td>
<td>Linear regressor model.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/linear_classifier.html">linear_classifier()</a></code></td>
<td>Linear classifier model.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/linear_dnn_combined_regressor.html">linear_dnn_combined_regressor()</a></code></td>
<td>Linear DNN Combined Regression.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/linear_dnn_combined_classifier.html">linear_dnn_combined_classifier()</a></code></td>
<td>Linear DNN Combined Classification.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/dynamic_rnn.html">dynamic_rnn()</a></code></td>
<td>Dynamic RNN Estimator..</td>
</tr>
<tr class="even">
<td><code><a href="../reference/state_saving_rnn.html">state_saving_rnn()</a></code></td>
<td>State Saving RNN Estimator.</td>
</tr>
</tbody>
</table>
<p>Before you can use an estimator you need to define a set of feature columns and provide an input function. The following two sections cover how to do this.</p>
</div>
<div id="feature-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#feature-columns" class="anchor"></a>Feature Columns</h2>
<p>Users firstly specify the feature columns that represent the feature transformations to be used by the Estimator. Here we use the default function <code><a href="../reference/feature_columns.html">feature_columns()</a></code> to automatically map each features in a dataset into a feature column according to their types, e.g. factor variable, numeric variable, etc.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars<span class="op">$</span>vs &lt;-<span class="st"> </span><span class="kw">as.factor</span>(mtcars<span class="op">$</span>vs)
dnn_feature_columns &lt;-<span class="st"> </span><span class="kw"><a href="../reference/feature_columns.html">feature_columns</a></span>(mtcars, <span class="kw"><a href="../reference/column_numeric.html">column_numeric</a></span>(drat))
linear_feature_columns &lt;-<span class="st"> </span><span class="kw"><a href="../reference/feature_columns.html">feature_columns</a></span>(mtcars, <span class="kw"><a href="../reference/column_numeric.html">column_numeric</a></span>(cyl))</code></pre></div>
<p>The examples above provide columns as-is from a data frame. There are also a variety of functions available for transforming features prior to using them in training:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/feature_columns.html">feature_columns()</a></code></td>
<td>Construct column placeholders from vectors in an R object</td>
</tr>
<tr class="even">
<td><code><a href="../reference/column_indicator.html">column_indicator()</a></code></td>
<td>Represents multi-hot representation of given categorical column.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/column_numeric.html">column_numeric()</a></code></td>
<td>Represents real valued or numerical features.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/column_embedding.html">column_embedding()</a></code></td>
<td>Creates an _DenseColumn that converts from sparse, categorical input.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/column_bucketized.html">column_bucketized()</a></code></td>
<td>Represents discretized dense input.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/column_weighted_categorical.html">column_weighted_categorical()</a></code></td>
<td>Applies weight values to a _CategoricalColumn.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/column_categorical_with_vocabulary_list.html">column_categorical_with_vocabulary_list()</a></code></td>
<td>Creates a _CategoricalColumn with in-memory vocabulary.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/column_categorical_with_vocabulary_file.html">column_categorical_with_vocabulary_file()</a></code></td>
<td>Creates a _CategoricalColumn with a vocabulary file.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/column_categorical_with_identity.html">column_categorical_with_identity()</a></code></td>
<td>Creates a _CategoricalColumn that returns identity values.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/column_categorical_with_hash_bucket.html">column_categorical_with_hash_bucket()</a></code></td>
<td>Represents sparse feature where ids are set by hashing.</td>
</tr>
</tbody>
</table>
<p>See the article on <a href="feature_columns.html">feature columns</a> for additional details.</p>
</div>
<div id="input-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#input-functions" class="anchor"></a>Input Functions</h2>
<p>Input functions are used to provide data to Estimtor training and prediction methods. The R interface provides several high-level input function implementations for various common R data sources, including:</p>
<ul>
<li>Formulas</li>
<li>Matrices</li>
<li>Data Frames</li>
<li>Lists of vectors</li>
</ul>
<p>For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input &lt;-<span class="st"> </span><span class="kw"><a href="../reference/input_fn.html">input_fn</a></span>(mtcars, <span class="dt">features =</span> <span class="kw">c</span>(drat, cyl), <span class="dt">response =</span> vs)</code></pre></div>
<p>You can also write fully custom input functions that draw data from arbitrary data sources. See the <a href="input_functions.html">input functions</a> article for additional details.</p>
</div>
<div id="creating-an-estimator" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-estimator" class="anchor"></a>Creating an Estimator</h2>
<p>Here’s an example of creating a Linear DNN Combined canned Estimator. In creating the estimator we pass the feature columns and other parameters that specifies the layers and architecture of the model. Note that for this particular canned Estimator, it takes two types of feature columns that are used for constructing linear layer and fully connected deep layers separately:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">classifier &lt;-
<span class="st">    </span><span class="kw"><a href="../reference/linear_dnn_combined_classifier.html">linear_dnn_combined_classifier</a></span>(
      <span class="dt">linear_feature_columns =</span> linear_feature_columns,
      <span class="dt">dnn_feature_columns =</span> dnn_feature_columns,
      <span class="dt">dnn_hidden_units =</span> <span class="kw">c</span>(3L, 3L),
      <span class="dt">dnn_optimizer =</span> <span class="st">"Adagrad"</span>
    )</code></pre></div>
</div>
<div id="training-and-prediction" class="section level2">
<h2 class="hasAnchor">
<a href="#training-and-prediction" class="anchor"></a>Training and Prediction</h2>
<p>Users can then call <code>train()</code> to train the initialized Estimator for a number of steps:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">classifier &lt;-<span class="st"> </span><span class="kw">train</span>(classifier, <span class="dt">input_fn =</span> custom_input_fn, <span class="dt">steps =</span> 2L)</code></pre></div>
<p>Once a model is trained, users can use <code>predict()</code> that makes predictions on a given input function that represents the inference data source. an argument named <code>type</code> can be <code>"raw"</code> so <code>predict()</code> will return the raw predictions outcomes, as well as <code>"prob"</code> and <code>"logistic"</code> that returns prediction probabilities and logistics if a model is of classification type.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(classifier, <span class="dt">input_fn =</span> custom_input_fn)
predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(classifier, <span class="dt">input_fn =</span> custom_input_fn, <span class="dt">type =</span> <span class="st">"prob"</span>)
predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(classifier, <span class="dt">input_fn =</span> custom_input_fn, <span class="dt">type =</span> <span class="st">"logistic"</span>)</code></pre></div>
<p>There’s also a function called <code>coef()</code> that can be used extract the trained coefficients of a model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coefs &lt;-<span class="st"> </span><span class="kw">coef</span>(classifier)</code></pre></div>
<p>There are a number of estimator methods which can be used generically with any canned or custom estimator:</p>
<p>To train and generate predictions with estimators you use the following set of generic functions:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/input_fn.html">input_fn()</a></code></td>
<td>Input function constructor from various types of input used to feed the estimator.</td>
</tr>
<tr class="even">
<td><code>train()</code></td>
<td>Trains a model given training data input_fn..</td>
</tr>
<tr class="odd">
<td><code>predict()</code></td>
<td>Returns predictions for given features.</td>
</tr>
<tr class="even">
<td><code>evaluate()</code></td>
<td>Evaluates the model given evaluation data input_fn.</td>
</tr>
<tr class="odd">
<td><code>export_savedmodel()</code></td>
<td>Exports inference graph as a SavedModel into a given directory.</td>
</tr>
</tbody>
</table>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#canned-estimators">Canned Estimators</a></li>
      <li><a href="#feature-columns">Feature Columns</a></li>
      <li><a href="#input-functions">Input Functions</a></li>
      <li><a href="#creating-an-estimator">Creating an Estimator</a></li>
      <li><a href="#training-and-prediction">Training and Prediction</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Yuan Tang, JJ Allaire, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>, Kevin Ushey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
