---
title: "R Interface to TensorFlow Estimators"
output: html_document
type: docs
menu:
  main:
    name: "Overview"
    identifier: "tfestimators-overview"
    parent: "tfestimators-using-tfestimators"
    weight: 10
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R Interface to TensorFlow Estimators

<div class="alert alert-warning" role="alert">
**IMPORTANT NOTE**: This package is under active development and the APIs are still subject to substantial changes. Help and documentation are also currently incomplete. The package is currently suitable for review and feedback but not for everyday use.
</div>



<img src="images/tensorflow-2-100709406-large.jpg" align="right" width="50%" style="margin-left: 15px;">


The **tfestimators** package is an R interface to TensorFlow Estimators, a high-level API that provides:

- Implementations of many different model types including linear models and deep neural networks. More models are coming soon such as state saving recurrent neural networks, dynamic recurrent neural networks, support vector machines, randome forest, KMeans clustering, etc. 

- A flexible framework for defining arbitrary new model types (Estimators)

- Standalone deployment of models (no R runtime required) in a wide variety of environments.

- An Experiment API that provides distributed training and hyperparameter tuning for both canned and custom estimators.

For more details and the design of the original Python API, please check out the paper: [TensorFlow Estimators: Managing Simplicity vs. Flexibility in High-Level Machine Learning Frameworks](http://terrytangyuan.github.io/data/papers/tf-estimators-kdd-paper.pdf).

## Quick Start

### Installation

To use **tfestimators** you need to install both the R package as well as [TensorFlow](https://rstudio.github.io/tensorflow/) iteslf.

First, install the tfestimators R package as follows:

```{r, eval=FALSE}
devtools::install_github("rstudio/tfestimators")
```

Then, use the `install_tensorflow()` function to install the current nightly build of TensorFlow (see the TensorFlow repository home page for [nightly build URLs](https://github.com/tensorflow/tensorflow#installation) for various platforms):

```{r, eval=FALSE}
library(tfestimators)
install_tensorflow(package_url = "https://ci.tensorflow.org/view/Nightly/<path-to-tf-package>")
```

<div class="alert alert-warning" role="alert">
**IMPORTANT NOTE**: The **tfestimators** package currently requires the nightly build of TensorFlow, it will not work with the release version as it relies on APIs only in the development version.
</div>




### Simple Example

Let's create a simple linear regression with the `mtcars` dataset to demonstrate the use of estimators.

#### Input Function

First, some standard setup. Input to estimators is provided by an input function that returns a list containing feature and response data. You can write a custom input function or create one automatically from an R data frame, matrix, or list.

Here we define a helper function that will return an input function for a given subset of our data:

```{r}
library(tfestimators)

# return an input_fn for a given subset of data
mtcars_input_fn <- function(data) {
  input_fn(data, features = c(disp, cyl), response = mpg)
}
```

The `input_fn` method can take an R data frame or matrix along with the names of feature and response variables and automatically create an input function for it.

#### Feature Columns

Next we define the feature columns for our model. Feature columns are mappings of raw input data to the data that we'll actually feed into our training, evaluation, and prediction steps. Here we create a list of feature columns containing the `disp` and `cyl` variables:

```{r}
fc <- feature_columns(
  column_numeric("disp"),
  column_numeric("cyl")
)
```

You can also define multiple feature columns at once:

```{r}
fc <- feature_columns( 
  column_numeric("disp", "cyl")
)
```

By using the family of [feature column functions](reference/index.html#section-feature-columns) we can define various transformations on the data before using it for modeling.

#### Estimator

We create the estimator by calling `linear_regressor()` function and passing it a set of feature columns: 

```{r}
model <- linear_regressor(fc)
```


#### Training

Next, we train the model using the `train()` function. Note that we segment `mtcars` into training and test datasets so we can evaluate the model on a differnet subset of data.

```{r}
# randomly segment mtcars into test and training datasets
mtcars <- mtcars[sample(1:nrow(mtcars)),]
test_obs <- as.integer(0.2 * nrow(mtcars))
train <- mtcars[-(1:test_obs),]
test <- mtcars[1:test_obs,]

# train the model
model %>% train(mtcars_input_fn(train))
```

#### Evaluation

We can evaluate the model's accuracy using the `evaluate()` function (here we use the `test` dataset rather than the `train` dataset):

```{r}
model %>% evaluate(mtcars_input_fn(test))
```

#### Prediction

Finally, we generate predictions using the `predict()` function:

```{r}
obs <- mtcars[1:3,]
model %>% predict(mtcars_input_fn(obs))
```

## Learning More

These articles cover the basics of using TensorFlow Estimators:

- [Estimator Basics](articles/estimator_basics.html)
- [Input Functions](articles/input_functions.html)
- [Feature Columns](articles/feature_columns.html)

<!--
These articles provide in depth documentation and example uses of canned estimators:

- [Linear Models](articles/linear_estimators.html)
- [Linear/DNN Models](articles/linear_dnn_combined_estimators.html)
- [Support Vector Machines](articles/support_vector_machines.html)
- [Recurrent Neural Networks](articles/recurrent_neural_networks.html)
-->

These articles describe more advanced topics/usage:

- [Experiments](articles/experiments.html)
- [Run Hooks](articles/run_hooks.html)
<!--
- [Run Configuration](articles/run_configuration.html)
-->
- [Custom Estimators](articles/creating_estimators.html)
- [TensorFlow Layers](articles/layers.html)
- [TensorBoard Visualization](articles/tensorboard.html)

One of the best ways to learn is from reviewing and experimenting with examples. See the [Examples](articles/examples/) page for a variety of examples to help you get started.

<!--
When you have built your model and are ready to deploy it, see the [Deployment](articles/deployment.html) page for an in-depth review of deployment options.
-->











