---
title: "R Interface to TensorFlow Estimators"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R Interface to TensorFlow Estimators

![](images/tensorflow-2-100709406-large.jpg){align=right width=50%}

The **tfestimators** package is an R interface to TensorFlow Estimators, a high-level API that provides:

- Implementations of many model types including linear models, support vector machines, deep neural networks, state saving recurrent neural networks, and dynamic recurrent neural networks.

- A flexible framework for defining arbitrary new model types (Estimators)

- An Experiment API that provides distributed training and hyperparameter tuning for both canned and custom estimators.

## Quick Start

### Installation

To use **tfestimators** you need to install both the R package as well as [TensorFlow](https://rstudio.github.io/tensorflow/) iteslf.

First, install the tfestimators R package as follows:

```{r, eval=FALSE}
devtools::install_github("rstudio/tfestimators")
```

Then, use the `install_tensorflow()` function to install TensorFlow:

```{r, eval=FALSE}
library(tfestimators)
install_tensorflow()
```

This will provide you with a default installation of TensorFlow suitable for use with the tfestimators R package. See the [article on TensorFlow installation](https://rstudio.github.io/tensorflow/installation.html) to learn about more advanced options.


### Using Estimators

Let's create a simple linear regression with the `mtcars` dataset to demonstrate the use of estimators.

First, we create the estimator using the `linear_regressor()` function:

```{r}
library(tfestimators)
model <- linear_regressor(feature_columns(mtcars, c("drat", "cyl")))
```

Then we train the model using the `mtcars` dataset. We'll do two things to setup for training:

1. Segment `mtcars` into training and test datasets; and

2. Define an input function that provides the feature and response data for training.

```{r}
# segment mtcars into test and training datasets
train <- mtcars[6:32,]
test <- mtcars[1:5,]

# helper to yield an input_fn for a given slice of mtcars
mtcars_input_fn <- function(data) {
  input_fn(data, response = "mpg", features = c("drat", "cyl"))
}

# train the model
model %>% train(mtcars_input_fn(train))
```

We can evaluate the model's accuracy using the `evaluate()` function (here we use the `test` dataset rather than the `train` dataset):

```{r}
model %>% evaluate(mtcars_input_fn(test))
```

Now we can generate predictions:

```{r}
model %>% predict(mtcars_input_fn(mtcars[1,]))
```




## Canned Estimators

The **tfestimators** package includes a wide variety of canned estimators for common machine learning tasks. Available estimators include:

| Estimator  | Description |
|------------------|----------------------------------------------------------------|
| `linear_regressor()`  | Linear regressor model.  |
| `linear_classifier()`  |  Linear classifier model. |
| `linear_dnn_combined_regressor()`  |  Linear DNN Combined Regression. |
| `linear_dnn_combined_classifier()`  |  Linear DNN Combined Classification. |
| `svm_classifier()`  |  TensorFlow -- Support Vector Machines. |
| `linear_dnn_combined_regressor()`  |  Dynamic RNN Estimator. |
| `dynamic_rnn()`  |  Linear DNN Combined Regression. |
| `state_saving_rnn()`  |  State Saving RNN Estimator. |

## Estimator Methods

To train and generate predictions with estimators you use the following set of generic functions:

| Method  | Description |
|------------------|----------------------------------------------------------------|
| `input_fn()`  |  Input function constructor from various types of input used to feed the estimator.  |
| `train()`  |  Trains a model given training data input_fn.. |
| `predict()`  |  Returns predictions for given features. |
| `evaluate()`  |  Evaluates the model given evaluation data input_fn. |
| `export_savedmodel` | Exports inference graph as a SavedModel into a given directory. |


## Learning More

See the [architecture overview](articles/architecture.html) to learn more about using TensorFlow Estimators.










