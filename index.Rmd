---
title: "R Interface to TensorFlow Estimators"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R Interface to TensorFlow Estimators

<style type="text/css">
.alert-warning {
    color: #8a6d3b;
    background-color: #fcf8e3;
    margin-top: 20px;
    margin-bottom: 20px;
    background-image: linear-gradient(to bottom,#fcf8e3 0,#f8efc0 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fffcf8e3', endColorstr='#fff8efc0', GradientType=0);
    background-repeat: repeat-x;
    border: 1px solid #f5e79e;
    border-radius: 4px;
}
</style>

<div class="alert alert-warning" role="alert">
**IMPORTANT NOTE**: This package is under active development and the APIs are still subject to substantial changes. Help and documentation are also currently incomplete. The package is currently suitable for review and feedback but not for everyday use.
</div>



<img src="images/tensorflow-2-100709406-large.jpg" align="right" width="50%" style="margin-left: 15px;">


The **tfestimators** package is an R interface to TensorFlow Estimators, a high-level API that provides:

- Implementations of many model types including linear models, support vector machines, deep neural networks, state saving recurrent neural networks, and dynamic recurrent neural networks.

- A flexible framework for defining arbitrary new model types (Estimators)

- Standalone deployment of models (no R runtime required) in a wide variety of environments.

- An Experiment API that provides distributed training and hyperparameter tuning for both canned and custom estimators.

## Quick Start

### Installation

To use **tfestimators** you need to install both the R package as well as [TensorFlow](https://rstudio.github.io/tensorflow/) iteslf.

First, install the tfestimators R package as follows:

```{r, eval=FALSE}
devtools::install_github("rstudio/tfestimators")
```

Then, use the `install_tensorflow()` function to install the current nightly build of TensorFlow (see the TensorFlow repository home page for [nightly build URLs](https://github.com/tensorflow/tensorflow#installation) for various platforms):

```{r, eval=FALSE}
library(tfestimators)
install_tensorflow(package_url = "https://ci.tensorflow.org/view/Nightly/<path-to-tf-package>")
```

Note that the **tfestimators** package currently requires the nightly build of TensorFlow, it will not work with the release version as it relies on APIs only in the development version.

### Simple Example

Let's create a simple linear regression with the `mtcars` dataset to demonstrate the use of estimators.

#### Input Function

First, some standard setup. Input to estimators is provided by an input function that returns a list containing feature and response data. You can write a custom input function or create one automatically from an R data frame or matrix.

Here we define a helper function that will yield an in input function for a given subset of our data:

```{r}
library(tfestimators)

# yield an input_fn for a given subset of data
mtcars_input_fn <- function(data) {
  input_fn(data, response = "mpg", features = c("drat", "cyl"))
}
```

The `input_fn` method can take an R data frame or matrix along with the names of feature and response variables and automatically create an input function for it.

#### Feature Columns

We create the estimator by calling `linear_regressor()` function and passing it a set of feature columns: 

```{r}
model <- linear_regressor(feature_columns(mtcars, c("drat", "cyl")))
```

In this case we're just passing columns from `mtcars` straight through, however by using the family of [feature column functions](reference/index.html#section-feature-columns) we can define various transformations on the data before using it for modeling.

#### Training

Next, we train the model using the `train()` function. Note that we segment `mtcars` into training and test datasets so we can evaluate the model on a differnet subset of data.

```{r}
# randomly segment mtcars into test and training datasets
mtcars <- mtcars[sample(1:nrow(mtcars)),]
test_obs <- as.integer(0.2 * nrow(mtcars))
train <- mtcars[-(1:test_obs),]
test <- mtcars[1:test_obs,]

# train the model
model %>% train(mtcars_input_fn(train))
```

#### Evaluation

We can evaluate the model's accuracy using the `evaluate()` function (here we use the `test` dataset rather than the `train` dataset):

```{r}
model %>% evaluate(mtcars_input_fn(test))
```

#### Prediction

Finally, we generate predictions using the `predict()` function:

```{r}
obs <- mtcars[1:3,]
model %>% predict(mtcars_input_fn(obs))
```

## Learning More

These articles cover the basics of using TensorFlow Estimators:

- [Using Estimators](articles/using_estimators.html)
- [Input Functions](articles/input_functions.html)
- [Feature Columns](articles/feature_columns.html)

<!--
These articles provide in depth documentation and example uses of canned estimators:

- [Linear Models](articles/linear_estimators.html)
- [Linear/DNN Models](articles/linear_dnn_combined_estimators.html)
- [Support Vector Machines](articles/support_vector_machines.html)
- [Recurrent Neural Networks](articles/recurrent_neural_networks.html)
-->

These articles describe more advanced topics/usage:

- [Experiments](articles/experiments.html)
- [Run Hooks](articles/run_hooks.html)
<!--
- [Run Configuration](articles/run_configuration.html)
-->
- [Custom Estimators](articles/custom_estimators.html)
- [TensorBoard Visualization](articles/tensorboard.html)

<!--
One of the best ways to learn is from reviewing and experimenting with examples. See the [Examples](articles/examples/examples.html) page for a variety of examples to help you get started.

When you have built your model and are ready to deploy it, see the [Deployment](articles/deployment.html) page for an in-depth review of deployment options.
-->











